{% extends 'users/base.html' %}

{% block body %}
<div class="messagePage mt-5 mb-5 pt-3 pb-3">
    <div class="container bg-light pt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="content-box bg-white shadow p-3 mb-5 rounded">
                    <div class="message">
                        <a class="backButton text-secondary mb-3 d-inline-block"
                            href="{% url request.session.last_page|default:'home' %}">
                            <i class="im im-angle-left"></i> Back
                        </a>
                        <h2 class="message__subject">
                            {% if message.subject %}
                            {{ message.subject }}
                            {% else %}
                            {{ message.body|truncatechars:40 }}
                            {% endif %}
                        </h2>
                        {% if message.sender == request.user.profile %}
                        <a href="{% url 'account' message.recipient.user.username %}"
                            class="message__author text-primary">
                            To: {{ message.recipient.user.username }}
                        </a>
                        {% else %}

                        <a href="{% url 'account' message.sender.user.username %}" class="message__author text-primary">
                            From: {{ message.name }}
                        </a>

                        {% endif %}



                        <p class="message__date text-muted">{{ message.created }}</p>
                        <div class="message__body mt-3 pb-3">{{ message.body|linebreaksbr }}</div>
                    </div>
                    {% if message.sender != request.user.profile %}
                    <form method="POST" action="{% url 'send_message' message.sender.id %}">
                        {% csrf_token %}
                        <textarea name="body" class="form-control" placeholder="Reply to this message..."></textarea>
                        <button type="submit" class="btn btn-outline-success btn-sm mt-2">Reply</button>
                    </form>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}