{% extends 'users/base.html' %}
{% load static %}
{% block body %}


<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'item:index' %}">Items</a></li>
        <li class="breadcrumb-item active" aria-current="page">Item Details</li>
    </ol>
</nav>
<!---->
<section style="background-color: #eee;">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6 col-xl-4">
                <div class="card text-black">
                    <i class="fab fa-apple fa-lg pt-3 pb-1 px-3"></i>
                    <img src="https://mdbcdn.b-cdn.net/img/Photos/Horizontal/E-commerce/Products/3.webp"
                        class="card-img-top" alt="Apple Computer" />
                    <div class="card-body">
                        <div class="text-center">
                            <h5 class="card-title">Believing is seeing</h5>
                            <p class="text-muted mb-4">Apple pro display XDR</p>
                        </div>
                        <div>
                            <div class="d-flex justify-content-between">
                                <span>Pro Display XDR</span><span>$5,999</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Pro stand</span><span>$999</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Vesa Mount Adapter</span><span>$199</span>
                            </div>
                        </div>
                        <div class="d-flex justify-content-between total font-weight-bold mt-4">
                            <span>Total</span><span>$7,197.00</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!---->
<div class="container">
    <div class="row">
        <div class="col-lg-6">
            <!-- Adjust the image container -->
            <img src="{{ item.item_image.url }}" class="img-fluid card-img-top" alt="{{ item.item_name }}">
        </div>
        <div class="col-lg-6">
            <!--  details -->
            <h3>Created by @ {{item.user_name}}</h3>
            <h1>{{ item.item_name }}</h1>
            <p>Description: {{ item.item_desc }}</p>
            <h3>Price: ${{ item.item_price }}</h3>




            <!-- Feedback section -->
            <div class="feedback mt-4">
                <h5>Feedback</h5>
                <p>100% Positive feedback (24 reviews)</p>
                {% if user.is_authenticated %}
                <form method="post">
                    {% csrf_token %}
                    <!--Comments -->
                    <input type="hidden" name="item_id" id="item_id" value="{{ item.id}}">
                    <input type="hidden" name="commented_by" id="commented_by" value="{{ request.user }}">
                    <textarea class="form-control square-textarea" id="id_body" name="body"
                        rows="4">{{ comment_form.body }} </textarea>
                    <button class="btn btn-primary mt-2" type="submit">Submit</button>
                </form>




                <!--Like-->
                <a id="{{ item.id }}" class="btn-like">
                    <img width="30" height="30" src="{% static 'pictures/like.png' %}">
                </a>
            </div>


            <!-- Existing feedbacks/comments -->
            <div class="existing-feedback mt-4">
                {% for comment in item.comment.all %}
                <b>{{ comment.commented_by }}</b>:
                {{ comment.body}}
                <br>
                {% endfor %}
            </div>

            {% else %} <!--Unregistered user-->
            <!-- Existing feedbacks/comments -->
            <div class="existing-feedback mt-4">
                {% for comment in item.comment.all %}
                <b>{{ comment.commented_by }}</b>:
                {{ comment.body}}
                <br>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
</div>


<!---->
<section style="background-color: #f7f6f6;">
    <div class="container my-5 py-5 text-dark">
        <div class="row d-flex justify-content-center">
            <div class="col-md-11 col-lg-9 col-xl-7">
                <div class="d-flex flex-start mb-4">
                    <img class="rounded-circle shadow-1-strong me-3"
                        src="https://mdbcdn.b-cdn.net/img/Photos/Avatars/img%20(32).webp" alt="avatar" width="65"
                        height="65" />
                    <div class="card w-100">
                        <div class="card-body p-4">
                            <div class="">
                                <h5>Johny Cash</h5>
                                <p class="small">3 hours ago</p>
                                <p>
                                    Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque
                                    ante sollicitudin. Cras purus odio, vestibulum in vulputate at, tempus
                                    viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla.
                                    Donec lacinia congue felis in faucibus ras purus odio, vestibulum in
                                    vulputate at, tempus viverra turpis.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="d-flex flex-start">
                    <img class="rounded-circle shadow-1-strong me-3"
                        src="https://mdbcdn.b-cdn.net/img/Photos/Avatars/img%20(31).webp" alt="avatar" width="65"
                        height="65" />
                    <div class="card w-100">
                        <div class="card-body p-4">
                            <div class="">
                                <h5>Mindy Campbell</h5>
                                <p class="small">5 hours ago</p>
                                <p>
                                    Lorem ipsum dolor sit, amet consectetur adipisicing elit. Delectus
                                    cumque doloribus dolorum dolor repellat nemo animi at iure autem fuga
                                    cupiditate architecto ut quam provident neque, inventore nisi eos quas?
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!---->

<!--change Like-->
<script type="text/javascript">
    window.CSRF_TOKEN = "{{ csrf_token }}";
    $(document).on('click', '.btn-like', function () {
        var item_id = this.id;
        $.ajax({
            method: "POST",
            url: '/item/like',
            data: { item_id: item_id, csrfmiddlewaretoken: window.CSRF_TOKEN }
        });
    });
</script>

<!--Clear comment body-->
<script>
    window.addEventListener('load', function () {
        document.getElementById('id_body').value = '';
    });
</script>

{% endblock %}